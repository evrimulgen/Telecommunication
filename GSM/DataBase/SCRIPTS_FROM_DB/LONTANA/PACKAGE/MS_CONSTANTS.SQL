
  CREATE OR REPLACE PACKAGE "LONTANA"."MS_CONSTANTS" AS
--
--#Version=1
--
-- Получить значение константы
--
  FUNCTION GET_CONSTANT_VALUE(CONSTANT_NAME VARCHAR2) RETURN VARCHAR2;
--
-- Установить значение константы (возвращает 0 если такой константы нет)
--
  FUNCTION SET_CONSTANT_VALUE(CONSTANT_NAME VARCHAR2, CONSTANT_VALUE VARCHAR2) RETURN INTEGER;
--
-- Добавить константу
--
  PROCEDURE NEW_CONSTANT(CONSTANT_NAME VARCHAR2, CONSTANT_VALUE VARCHAR2,
    CONSTANT_DESCR VARCHAR2, CONSTANT_TYPE VARCHAR2,
    pPAGE_NAME     VARCHAR2 DEFAULT NULL, pORDER_NUMBER INTEGER DEFAULT NULL, 
    pCAPTION       VARCHAR2 DEFAULT NULL);
--    
  PRAGMA RESTRICT_REFERENCES ( GET_CONSTANT_VALUE, WNDS, WNPS );
--
END; 
CREATE OR REPLACE PACKAGE BODY "LONTANA"."MS_CONSTANTS" AS
--
  FUNCTION GET_CONSTANT_VALUE(CONSTANT_NAME VARCHAR2) RETURN VARCHAR2 IS
    S VARCHAR2(256);
  BEGIN
    SELECT VALUE INTO S FROM CONSTANTS WHERE NAME = CONSTANT_NAME;
        RETURN (S);
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
          RETURN (NULL);
  END;
--
-- Установить значение константы
--
  FUNCTION SET_CONSTANT_VALUE(CONSTANT_NAME VARCHAR2, CONSTANT_VALUE VARCHAR2) RETURN INTEGER IS
  BEGIN
    UPDATE CONSTANTS SET VALUE = CONSTANT_VALUE WHERE NAME = CONSTANT_NAME;
        RETURN (TO_CHAR(SQL%ROWCOUNT));
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
          RETURN (NULL);
  END;
--
-- Добавить константу
--
  PROCEDURE NEW_CONSTANT(CONSTANT_NAME VARCHAR2, CONSTANT_VALUE VARCHAR2,
    CONSTANT_DESCR VARCHAR2, CONSTANT_TYPE VARCHAR2,
    pPAGE_NAME     VARCHAR2 DEFAULT NULL, pORDER_NUMBER INTEGER DEFAULT NULL, 
    pCAPTION       VARCHAR2 DEFAULT NULL) IS
  BEGIN
    INSERT INTO CONSTANTS
        (CONSTANT_ID, NAME, DESCR, TYPE, VALUE, PAGE_NAME, ORDER_NUMBER, CAPTION)

        VALUES
        (New_Constant_Id, CONSTANT_NAME, CONSTANT_DESCR, CONSTANT_TYPE, CONSTANT_VALUE,
         pPAGE_NAME, pORDER_NUMBER, pCAPTION);
  END;
END; 