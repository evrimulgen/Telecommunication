
  CREATE OR REPLACE FORCE VIEW "LONTANA"."CRM_V_BALANCES" ("ROW_DATE", "COST_PLUS", "COST_MINUS", "ROW_COMMENT") AS 
  SELECT "ROW_DATE","COST_PLUS","COST_MINUS","ROW_COMMENT" FROM
(
SELECT
  ABONENT_BALANCE_ROWS.ROW_DATE, 
  ABONENT_BALANCE_ROWS.ROW_COST AS COST_PLUS,
  TO_NUMBER(NULL) AS COST_MINUS,
  ABONENT_BALANCE_ROWS.ROW_COMMENT
FROM
  ABONENT_BALANCE_ROWS
  WHERE ABONENT_BALANCE_ROWS.ROW_COST > 0
UNION ALL
SELECT
  ABONENT_BALANCE_ROWS.ROW_DATE, 
  TO_NUMBER(NULL) AS COST_PLUS,
  -ABONENT_BALANCE_ROWS.ROW_COST AS COST_MINUS,
  ABONENT_BALANCE_ROWS.ROW_COMMENT
FROM
  ABONENT_BALANCE_ROWS
  WHERE ABONENT_BALANCE_ROWS.ROW_COST < 0
)
ORDER BY
  ROW_DATE