
  CREATE OR REPLACE FORCE VIEW "LONTANA"."CRM_V_DETAILS" ("YEAR", "MONTH", "ESTIMATE_SUM", "PHONE_NUMBER", "ZEROCOST_OUTCOME_MINUTES", "ZEROCOST_OUTCOME_COUNT", "CALLS_COUNT", "CALLS_MINUTES", "CALLS_COST", "SMS_COUNT", "SMS_COST", "MMS_COUNT", "MMS_COST", "SMS_MMS_COUNT", "SMS_MMS_COST", "INTERNET_MB", "INTERNET_COST", "LAST_CHECK_DATE_TIME", "OTHER_COST") AS 
  SELECT
  TRUNC(DB_LOADER_PHONE_STAT.YEAR_MONTH / 100) YEAR,
  DB_LOADER_PHONE_STAT.YEAR_MONTH - TRUNC(DB_LOADER_PHONE_STAT.YEAR_MONTH / 100)*100 MONTH,
  DB_LOADER_PHONE_STAT.ESTIMATE_SUM,
  DB_LOADER_PHONE_STAT.PHONE_NUMBER,
  DB_LOADER_PHONE_STAT.ZEROCOST_OUTCOME_MINUTES,
  DB_LOADER_PHONE_STAT.ZEROCOST_OUTCOME_COUNT,
  DB_LOADER_PHONE_STAT.CALLS_COUNT,
  DB_LOADER_PHONE_STAT.CALLS_MINUTES,
  DB_LOADER_PHONE_STAT.CALLS_COST,
  DB_LOADER_PHONE_STAT.SMS_COUNT,
  DB_LOADER_PHONE_STAT.SMS_COST,
  DB_LOADER_PHONE_STAT.MMS_COUNT,
  DB_LOADER_PHONE_STAT.MMS_COST,
  DB_LOADER_PHONE_STAT.SMS_COUNT + DB_LOADER_PHONE_STAT.MMS_COUNT SMS_MMS_COUNT,
  DB_LOADER_PHONE_STAT.SMS_COST + DB_LOADER_PHONE_STAT.MMS_COST SMS_MMS_COST,
  DB_LOADER_PHONE_STAT.INTERNET_MB,
  DB_LOADER_PHONE_STAT.INTERNET_COST,
  DB_LOADER_PHONE_STAT.LAST_CHECK_DATE_TIME,
  DB_LOADER_PHONE_STAT.ESTIMATE_SUM
   - DB_LOADER_PHONE_STAT.CALLS_COST
   - DB_LOADER_PHONE_STAT.SMS_COST
   - DB_LOADER_PHONE_STAT.MMS_COST
   - DB_LOADER_PHONE_STAT.INTERNET_COST   OTHER_COST
FROM
  DB_LOADER_PHONE_STAT
ORDER BY 
  DB_LOADER_PHONE_STAT.YEAR_MONTH DESC