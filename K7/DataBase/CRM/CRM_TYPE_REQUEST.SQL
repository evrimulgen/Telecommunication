CREATE TABLE CRM_TYPE_REQUEST(
  TYPE_REQUEST_ID INTEGER,
  TYPE_NAME       VARCHAR2(30 CHAR)
);

CREATE UNIQUE INDEX PK_CRM_TYPE_REQUEST ON CRM_TYPE_REQUEST(TYPE_REQUEST_ID);

ALTER TABLE CRM_TYPE_REQUEST ADD (
  CONSTRAINT PK_CRM_TYPE_REQUEST
  PRIMARY KEY
  (TYPE_REQUEST_ID)
  USING INDEX PK_CRM_TYPE_REQUEST);

ALTER TABLE CRM_TYPE_REQUEST ADD (TEXT_SMS VARCHAR2(512 CHAR));
ALTER TABLE CRM_TYPE_REQUEST DROP COLUMN TEXT_SMS;

ALTER TABLE CRM_TYPE_REQUEST ADD (TEXT_SMS_OPEN VARCHAR2(512 CHAR));
ALTER TABLE CRM_TYPE_REQUEST ADD (TEXT_SMS_CLOSE VARCHAR2(512 CHAR));

GRANT SELECT, INSERT, DELETE, UPDATE ON CRM_TYPE_REQUEST TO CRM_USER;
CREATE SYNONYM CRM_USER.TYPE_REQUEST FOR CRM_TYPE_REQUEST;

CREATE SEQUENCE S_TYPE_REQUEST;

CREATE OR REPLACE TRIGGER TIU_CRM_TYPE_REQUEST
  BEFORE INSERT OR UPDATE ON CRM_TYPE_REQUEST FOR EACH ROW
--#Version=1
BEGIN
  IF INSERTING THEN
    IF NVL(:NEW.TYPE_REQUEST_ID, 0) = 0 then
      :NEW.TYPE_REQUEST_ID := S_TYPE_REQUEST.NEXTVAL;
    END IF;
  END IF;
END;
