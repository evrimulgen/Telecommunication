
  CREATE OR REPLACE FUNCTION "CORP_MOBILE"."CALC_BALANCE_ROWS_TABLE" (
  pPHONE_NUMBER IN VARCHAR2
  ) RETURN BALANCE_ROW_TAB PIPELINED AS
--#Version=1
  vDATE_ROWS DBMS_SQL.DATE_TABLE;
  vCOST_ROWS DBMS_SQL.NUMBER_TABLE;
  vDESCRIPTION_ROWS DBMS_SQL.VARCHAR2_TABLE;
  I BINARY_INTEGER;
BEGIN
  CALC_BALANCE_ROWS2(pPHONE_NUMBER, vDATE_ROWS, vCOST_ROWS, vDESCRIPTION_ROWS);
  -- 
  I := vDATE_ROWS.FIRST;
  WHILE I IS NOT NULL LOOP
    PIPE ROW(
      BALANCE_ROW_TYPE(
        vDATE_ROWS(I),
        vCOST_ROWS(I),
        vDESCRIPTION_ROWS(I)
        )
      );
    I := vDATE_ROWS.NEXT(I);
  END LOOP;
END;