
  CREATE OR REPLACE FUNCTION "CORP_MOBILE"."GET_IS_COLLECTOR_BY_PHONE" (
  pPHONE_NUMBER IN VARCHAR2
  ) RETURN INTEGER IS
--Vesion=1
CURSOR C IS
  SELECT nvl(ACCOUNTS.IS_COLLECTOR,0) IS_COLLECTOR
    FROM DB_LOADER_ACCOUNT_PHONES,
         ACCOUNTS
    WHERE DB_LOADER_ACCOUNT_PHONES.PHONE_NUMBER=pPHONE_NUMBER
      AND DB_LOADER_ACCOUNT_PHONES.ACCOUNT_ID=ACCOUNTS.ACCOUNT_ID(+)
    ORDER BY DB_LOADER_ACCOUNT_PHONES.LAST_CHECK_DATE_TIME DESC;
DUMMY NUMBER;
ITOG NUMBER;
BEGIN
  OPEN C;
  FETCH C INTO DUMMY;
  IF C%FOUND THEN
    ITOG:=DUMMY;
  ELSE
    ITOG:=0;
  END IF;
  CLOSE C;
  RETURN ITOG;
END;
