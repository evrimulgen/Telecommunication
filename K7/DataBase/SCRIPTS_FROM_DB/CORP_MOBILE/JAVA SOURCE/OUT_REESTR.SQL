
   CREATE JAVA SOURCE NAMED "CORP_MOBILE"."OUT_REESTR" AS 
 import java.io.BufferedReader;import java.io.Reader;import java.io.StringReader;import java.io.*;import java.util.StringTokenizer;import java.sql.*;import oracle.sql.CLOB;import oracle.jdbc.driver.*; public class OUT_CSV_REESTR { public static String  replace(String str, String find,String replace) {    StringBuffer sb = new StringBuffer("");    int index;    int offset = 0;    for(index = str.indexOf(find); index != -1; index = str.indexOf(find)){      sb.append( str.substring(0, index) );      sb.append( replace );      offset = index + find.length();      str = str.substring( offset );    }   sb.append(str);   return sb.toString();}  public static oracle.sql.CLOB replaceClob(oracle.sql.CLOB cont, String find,String replace) throws SQLException,IOException {      String content;      int length;      StringBuffer buf;      CLOB clob=null;      java.io.Writer out=null;      Connection con = null;        try {            if (cont != null) {               buf = new StringBuffer("");               Reader is = cont.getCharacterStream();               char buffer[] = new char[8192];               while((length=is.read(buffer,0,8192)) != -1)                 buf.append(buffer,0,length);               content=buf.toString();               content=replace(content,find,replace);               //content.replaceAll(find,replace);             }             else             return null;                        con=new OracleDriver().defaultConnection();            clob = CLOB.createTemporary(con, true, CLOB.DURATION_SESSION);            out=clob.setCharacterStream(0);            out.write(content);                    } catch (Exception ex) {           return null;        }        finally {           if(out!=null) out.close();     }        return clob;    }}