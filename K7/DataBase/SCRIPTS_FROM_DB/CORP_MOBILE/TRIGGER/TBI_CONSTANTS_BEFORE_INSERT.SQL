
  CREATE OR REPLACE TRIGGER "CORP_MOBILE"."TBI_CONSTANTS_BEFORE_INSERT" 
  BEFORE INSERT OR UPDATE ON CONSTANTS
  FOR EACH ROW
DECLARE 
  vRES VARCHAR2(30 CHAR);
  vTEMP VARCHAR2(30 CHAR);
  vRESn NUMBER;
--#Version=1
BEGIN
  IF INSERTING THEN
    IF NVL(:NEW.CONSTANT_ID, 0) <= 0 THEN
      :NEW.CONSTANT_ID := new_constant_id;
    END IF;
  END IF;
  vRES:=:NEW.ACCESS_VERSTION_STRING;
  vRESn:=0;
  BEGIN
    --Читаем 1ую
    vTEMP:=SUBSTR(vRES, 1, INSTR(vRES, '.')-1);
    vRES:=SUBSTR(vRES, INSTR(vRES, '.') + 1);
    vRESn:=vRESn + TO_NUMBER(vTEMP) * 1000;
    --Читаем 2ую
    vTEMP:=SUBSTR(vRES, 1, INSTR(vRES, '.')-1);
    vRES:=SUBSTR(vRES, INSTR(vRES, '.') + 1);
    vRESn:=vRESn + TO_NUMBER(vTEMP);
    --Читаем 3ую
    vTEMP:=SUBSTR(vRES, 1, INSTR(vRES, '.')-1);
    vRES:=SUBSTR(vRES, INSTR(vRES, '.') + 1);
    vRESn:=vRESn + TO_NUMBER(vTEMP)/1000;
    --Читаем последнюю
    vRESn:=vRESn + TO_NUMBER(vRES)/1000/1000;    
  EXCEPTION
    WHEN OTHERS THEN
      vRESn:=0;
  END;
  :NEW.ACCESS_VERSTION:=vRESn;
END; 
ALTER TRIGGER "CORP_MOBILE"."TBI_CONSTANTS_BEFORE_INSERT" ENABLE