
  CREATE OR REPLACE TRIGGER "CORP_MOBILE"."TIU_ACCOUNT_INFO" 
BEFORE INSERT OR UPDATE
ON ACCOUNT_INFO
REFERENCING NEW AS New OLD AS Old
FOR EACH ROW
BEGIN
  IF INSERTING THEN
    :NEW.USER_CREATED := USER;
    :NEW.DATE_CREATED := SYSDATE;
  END IF;  
  :NEW.USER_LAST_UPDATED := USER;
  :NEW.DATE_LAST_UPDATED := SYSDATE;
  
  --заполнение таблицы истории
  INSERT INTO ACCOUNT_INFO_HISTORY (ID_ACCOUNT_INFO_HISTORY, ACCOUNT_ID, BALANCE, 
    COUNT_PHONE, USER_UPDATE, DATE_UPDATE) 
  VALUES (S_NEW_ID_ACCOUNT_INFO_HISTORY.NEXTVAL, :NEW.ACCOUNT_ID, :NEW.BALANCE, 
    :NEW.COUNT_PHONE, :NEW.USER_LAST_UPDATED, sysdate);
  
END TIU_ACCOUNT_INFO;
ALTER TRIGGER "CORP_MOBILE"."TIU_ACCOUNT_INFO" ENABLE