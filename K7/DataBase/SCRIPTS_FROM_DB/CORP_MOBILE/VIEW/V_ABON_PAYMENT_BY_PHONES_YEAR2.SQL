
  CREATE OR REPLACE FORCE VIEW "CORP_MOBILE"."V_ABON_PAYMENT_BY_PHONES_YEAR2" ("ACCOUNT_ID", "PHONE_NUMBER", "BILL_YEAR", "TARIFF_NAME", "PAYMENT_01", "PAYMENT_02", "PAYMENT_03", "PAYMENT_04", "PAYMENT_05", "PAYMENT_06", "PAYMENT_07", "PAYMENT_08", "PAYMENT_09", "PAYMENT_10", "PAYMENT_11", "PAYMENT_12", "PAYMENT_FOR_YEAR", "BALANCE", "PROFIT_FOR_YEAR") AS 
  SELECT
--#Version=1
--
-- Возвращается абонплата для абонента в разрезе номеров телефонов с делением по месяцам.
-- В полях PAYMENT_01 - PAYMENT_12 показана доходность за январь, февраль и т.п.
-- В поле BALANCE показан текущий баланс абонента.
-- В поле PROFIT_FOR_YEAR показана доходность за год.
--
  V_ABON_PAYMENT_BY_PHONES_YEAR."ACCOUNT_ID",V_ABON_PAYMENT_BY_PHONES_YEAR."PHONE_NUMBER",V_ABON_PAYMENT_BY_PHONES_YEAR."BILL_YEAR",V_ABON_PAYMENT_BY_PHONES_YEAR."TARIFF_NAME",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_01",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_02",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_03",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_04",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_05",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_06",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_07",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_08",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_09",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_10",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_11",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_12",V_ABON_PAYMENT_BY_PHONES_YEAR."PAYMENT_FOR_YEAR",V_ABON_PAYMENT_BY_PHONES_YEAR."BALANCE",
  V_PROFIT_BY_PHONES_YEAR.PROFIT_FOR_YEAR
FROM
  V_ABON_PAYMENT_BY_PHONES_YEAR,
  V_PROFIT_BY_PHONES_YEAR
WHERE 
  V_ABON_PAYMENT_BY_PHONES_YEAR.PHONE_NUMBER=V_PROFIT_BY_PHONES_YEAR.PHONE_NUMBER
  AND V_ABON_PAYMENT_BY_PHONES_YEAR.BILL_YEAR=V_PROFIT_BY_PHONES_YEAR.BILL_YEAR 