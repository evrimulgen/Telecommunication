
  CREATE OR REPLACE FORCE VIEW "CORP_MOBILE"."V_PROFIT_BY_PHONES" ("ACCOUNT_ID", "YEAR_MONTH", "PHONE_NUMBER", "OPERATOR_BILL_SUM", "CLIENT_BILL_SUM", "PROFIT_SUM") AS 
  SELECT V.ACCOUNT_ID,
       V.YEAR_MONTH,
       V.PHONE_NUMBER,
       CASE 
         WHEN V.BEELINE_BILL_SUM < 0 THEN 0
         ELSE V.BEELINE_BILL_SUM
       END AS OPERATOR_BILL_SUM,
       X.BILL_SUMM CLIENT_BILL_SUM,
       CASE
         WHEN V.BEELINE_BILL_SUM < 0 THEN 0
         ELSE NVL(X.BILL_SUMM, 0) - NVL(V.BEELINE_BILL_SUM, 0)
       END AS PROFIT_SUM
  FROM V_BEELINE_BILL_small v --V_BEELINE_BILLS V
  FULL OUTER JOIN TARIFER_BILL_FOR_CLIENTS X
    ON X.YEAR_MONTH = V.YEAR_MONTH AND X.PHONE_NUMBER = V.PHONE_NUMBER 