
  CREATE OR REPLACE FORCE VIEW "CORP_MOBILE"."V_TARIFER_BILL_FOR_GROUP_DET" ("YEAR_MONTH", "PHONE_NUMBER", "BILL_SUMM", "ABON_TP", "ABON_ADD", "DISCOUNT", "SINGLE_PAYMENTS", "SINGLE_CHANGE_TARIFF", "CALLS", "CALLS_COUNTRY", "CALLS_SITY", "CALLS_LOCAL", "CALLS_SMS_MMS", "CALLS_GPRS", "CALLS_RUS_RPP", "CALLS_ALL", "ROUMING_NATIONAL", "ROUMING_INTERNATIONAL", "SINGLE_CORRECTION", "CONTRACT_ID", "CONTRACT_NUM", "CONTRACT_DATE", "FILIAL_ID", "OPERATOR_ID", "PHONE_NUMBER_FEDERAL", "PHONE_NUMBER_CITY", "PHONE_NUMBER_TYPE", "TARIFF_ID", "SIM_NUMBER", "CONTRACT_CHANGE_DATE", "SERVICE_ID", "DISCONNECT_LIMIT", "CONNECT_LIMIT", "CONFIRMED", "USER_CREATED", "DATE_CREATED", "USER_LAST_UPDATED", "DATE_LAST_UPDATED", "ABONENT_ID", "HAND_BLOCK", "HAND_BLOCK_DATE_END", "IS_CREDIT_CONTRACT", "CONTRACT_CANCEL_DATE", "DOP_STATUS", "BALANCE_NOTICE_HAND_BLOCK", "BALANCE_BLOCK_HAND_BLOCK", "DEALER_KOD", "GROUP_ID", "COMMENTS", "START_BALANCE") AS 
  SELECT B.YEAR_MONTH, B.PHONE_NUMBER, B.BILL_SUMM, B.ABON_TP, B.ABON_ADD, B.DISCOUNT, B.SINGLE_PAYMENTS, B.SINGLE_CHANGE_TARIFF, 
         B.CALLS, B.CALLS_COUNTRY, B.CALLS_SITY, B.CALLS_LOCAL, B.CALLS_SMS_MMS, B.CALLS_GPRS, B.CALLS_RUS_RPP, B.CALLS_ALL, 
         B.ROUMING_NATIONAL, B.ROUMING_INTERNATIONAL, B.SINGLE_CORRECTION,
         C."CONTRACT_ID",C."CONTRACT_NUM",C."CONTRACT_DATE",C."FILIAL_ID",C."OPERATOR_ID",C."PHONE_NUMBER_FEDERAL",C."PHONE_NUMBER_CITY",C."PHONE_NUMBER_TYPE",C."TARIFF_ID",C."SIM_NUMBER",C."CONTRACT_CHANGE_DATE",C."SERVICE_ID",C."DISCONNECT_LIMIT",C."CONNECT_LIMIT",C."CONFIRMED",C."USER_CREATED",C."DATE_CREATED",C."USER_LAST_UPDATED",C."DATE_LAST_UPDATED",C."ABONENT_ID",C."HAND_BLOCK",C."HAND_BLOCK_DATE_END",C."IS_CREDIT_CONTRACT",C."CONTRACT_CANCEL_DATE",C."DOP_STATUS",C."BALANCE_NOTICE_HAND_BLOCK",C."BALANCE_BLOCK_HAND_BLOCK",C."DEALER_KOD",C."GROUP_ID",C."COMMENTS",C."START_BALANCE"
    FROM TARIFER_BILL_FOR_CLIENTS b, v_contracts c
    WHERE b.phone_number = c.phone_number_federal
      AND c.contract_date < ADD_MONTHS (TO_DATE (b.year_month || '01', 'yyyymmdd'), 1)
      AND (c.contract_cancel_date IS NULL
          OR c.contract_cancel_date >= TO_DATE (b.year_month || '01', 'yyyymmdd') )
      AND c.GROUP_ID IS NOT NULL 