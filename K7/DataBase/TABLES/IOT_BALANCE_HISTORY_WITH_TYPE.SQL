CREATE TABLE CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE
(
  BHWT_ID       INTEGER                         NOT NULL,
  PHONE_NUMBER  NUMBER,
  LAST_UPDATE   DATE,
  UPDATE_TYPE   NUMBER,
  BALANCE       NUMBER, 
  CONSTRAINT PK_BALANCE_HISTORY_WT
  PRIMARY KEY
  (BHWT_ID)
  ENABLE VALIDATE
)
ORGANIZATION INDEX
PCTTHRESHOLD 50
TABLESPACE USERS
RESULT_CACHE (MODE DEFAULT)
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOPARALLEL
NOMONITORING;

COMMENT ON TABLE CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE IS 'рейсыхе аюкюмяш днцнбнпмшу мнлепнб';

COMMENT ON COLUMN CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE.PHONE_NUMBER IS 'мнлеп ';

COMMENT ON COLUMN CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE.LAST_UPDATE IS 'дюрю ябефеярх';

COMMENT ON COLUMN CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE.UPDATE_TYPE IS 'нрйсдю опхькн намнбкемхе';

COMMENT ON COLUMN CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE.BALANCE IS 'аюкюмя';



-- Index PK_BALANCE_HISTORY_WT is created automatically by Oracle with index organized table IOT_BALANCE_HISTORY_WITH_TYPE.


CREATE OR REPLACE TRIGGER CORP_MOBILE.TI_BHWT
  BEFORE INSERT ON CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE FOR EACH ROW
DECLARE

BEGIN
      :NEW.BHWT_ID:= BHWT_NEW.NEXTVAL;
END;
/


ALTER TABLE CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE ADD (
  CONSTRAINT PK_UPD_TYPE_WT 
  FOREIGN KEY (UPDATE_TYPE) 
  REFERENCES CORP_MOBILE.QCB_TYPES (QCB_ID)
  ENABLE VALIDATE);

GRANT SELECT ON CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE TO CORP_MOBILE_ROLE;

GRANT SELECT ON CORP_MOBILE.IOT_BALANCE_HISTORY_WITH_TYPE TO CORP_MOBILE_ROLE_RO;

CREATE INDEX I_IOT_BALANCE_HIST_W_TP_PHONE ON IOT_BALANCE_HISTORY_WITH_TYPE(PHONE_NUMBER) COMPRESS;
