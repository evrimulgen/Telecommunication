object ReportVirtualPaymentsForm: TReportVirtualPaymentsForm
  Left = 0
  Top = 0
  Caption = #1042#1080#1088#1090#1091#1072#1083#1100#1085#1099#1077' '#1087#1083#1072#1090#1077#1078#1080
  ClientHeight = 491
  ClientWidth = 1082
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -10
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  Position = poScreenCenter
  OnCreate = FormCreate
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 12
  object gReport: TCRDBGrid
    Left = 0
    Top = 36
    Width = 1082
    Height = 455
    Margins.Left = 2
    Margins.Top = 2
    Margins.Right = 2
    Margins.Bottom = 2
    Align = alClient
    DataSource = dsReport
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clWindowText
    Font.Height = -11
    Font.Name = 'Tahoma'
    Font.Style = []
    ParentFont = False
    ReadOnly = True
    TabOrder = 0
    TitleFont.Charset = DEFAULT_CHARSET
    TitleFont.Color = clWindowText
    TitleFont.Height = -13
    TitleFont.Name = 'Tahoma'
    TitleFont.Style = [fsBold]
    Columns = <
      item
        Expanded = False
        FieldName = 'COMPANY_NAME'
        Title.Alignment = taCenter
        Width = 170
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'PHONE_NUMBER'
        Title.Alignment = taCenter
        Width = 82
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'PAYMENT_SUM'
        Title.Alignment = taCenter
        Width = 64
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'PAYMENT_DATE_TIME'
        Title.Alignment = taCenter
        Width = 64
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'RECEIVED_PAYMENT_TYPE_NAME'
        Title.Alignment = taCenter
        Title.Caption = #1058#1080#1087' '#1087#1083#1072#1090#1077#1078#1072
        Width = 114
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'USER_CREATED'
        Title.Alignment = taCenter
        Width = 76
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'DATE_CREATED'
        Title.Alignment = taCenter
        Width = 112
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'USER_LAST_UPDATED'
        Title.Alignment = taCenter
        Width = 76
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'DATE_LAST_UPDATED'
        Title.Alignment = taCenter
        Width = 112
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'REMARK'
        Title.Alignment = taCenter
        Width = 181
        Visible = True
      end>
  end
  object pButton: TPanel
    Left = 0
    Top = 0
    Width = 1082
    Height = 36
    Align = alTop
    BevelOuter = bvNone
    TabOrder = 1
    ExplicitWidth = 737
    object Label1: TLabel
      Left = 7
      Top = 9
      Width = 55
      Height = 19
      Caption = #1055#1077#1088#1080#1086#1076
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -16
      Font.Name = 'Tahoma'
      Font.Style = []
      ParentFont = False
    end
    object btLoadInExcel: TBitBtn
      Left = 207
      Top = 3
      Width = 138
      Height = 28
      Caption = #1042#1099#1075#1088#1091#1079#1080#1090#1100' '#1074' Excel'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -12
      Font.Name = 'Tahoma'
      Font.Style = []
      Glyph.Data = {
        36090000424D3609000000000000360000002800000018000000180000000100
        2000000000000009000000000000000000000000000000000000FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00525A520084948C0042524A0073847300395239006B84
        73003952390073947B00526B52007B9C8400395A420073947300315231006B8C
        63004A6B4A008CA58C00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00849484002942310073847300425A42006B846B004263
        4A0073947300294A31006B8C6B00395A39006B8C6B00315231007BAD84002952
        29006B8C6B00314A3100FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00425242007B947B00E7FFE700EFFFF700EFFFF700E7FF
        EF00EFFFEF00EFFFEF00EFFFEF00EFFFEF00EFFFEF00E7FFEF00D6FFDE00E7FF
        E700315A31006B946B00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00738C7300395A3900EFFFEF00D6FFD600E7FFEF00DEFF
        E700E7FFEF00DEFFE700DEFFE7005A8C5A00396B390063946300316331005A94
        5A0073A57B0029522900FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF0042633900638C5A00E7FFE700215A210063A56B002163
        29005A9C6300185A210052945A00216B2900DEFFDE00185A21005A945A00396B
        3900214A2100638C6300FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00638C630042733900DEFFDE0063A55A00105A1000529C
        5A00317B39005AAD630029733100D6FFD6001863180063AD630039733900D6FF
        D6007BA57B004A6B4A00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00395A31006B945A00DEFFCE00316B210073B56B002973
        2900428C420018631800DEFFD600185A1000529C5200216318005A945A00DEFF
        DE00184A21006B947300FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00849C7B004A6B3900DEFFD600E7FFDE00215A2100528C
        520039733900DEFFDE00216321006BA56B0031733100639C6300215A2100E7FF
        E7006B946B00315A3100FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF003142310063846300EFFFEF00E7FFE700E7FFEF004273
        4A00D6FFDE00296339005A8C6B00295A310063946B00DEFFE700DEFFE700DEFF
        DE00315A31007B9C7B00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF0073846B0052735200EFFFEF00E7FFE70021522900E7FF
        EF00295A31006B9C7B00315A3900638C630039633900739C7300E7FFE700E7FF
        E7005A845A004A6B4A00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF004A63390073946300E7FFDE0031632900E7FFDE003163
        290073A56B001852180063945A00427339006B9C63003163290073A57300DEFF
        DE0052735200637B6300FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF007B9C6B00395A2900E7FFDE0073A56B00316B31005A8C
        5A00316331006B9C6B00E7FFE700639463003963290063945A0029522900EFFF
        EF005A735A00425A4200FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00395239006B8C6B00E7FFE700315A390052845A004A73
        52005A846B00DEFFE700E7FFEF00DEFFE700638C6B002952290073946B00EFFF
        EF00395A42007B948400FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF0084A58C00294A2900E7FFEF00E7FFEF00E7FFEF00DEFF
        EF00DEFFEF00E7FFEF00E7FFF700E7FFEF00EFFFEF00EFFFEF00EFFFEF00E7FF
        E700738C7300314A3100FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00315A290073A5730021522100639C6300396B3900638C
        6300396339006B9C6B00214A2100638C5A00426331005A845200395231008494
        7B004A634A007B8C7B00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF006B8C63003963310084AD8400214A2100527B5200426B
        4200739C7300315A31007B9C73004A6B3900738C630042633900849C7B004252
        390073847300394A3900FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00}
      ParentFont = False
      ParentShowHint = False
      ShowHint = True
      TabOrder = 0
      OnClick = btLoadInExcelClick
    end
    object cbPeriod: TComboBox
      Left = 80
      Top = 9
      Width = 121
      Height = 22
      Style = csDropDownList
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -12
      Font.Name = 'Tahoma'
      Font.Style = []
      ParentFont = False
      TabOrder = 1
      OnChange = cbPeriodChange
    end
  end
  object qReport: TOraQuery
    SQL.Strings = (
      'select '
      '  res.PHONE_NUMBER,'
      '  res.PAYMENT_SUM,'
      '  res.PAYMENT_DATE_TIME,'
      '  res.USER_CREATED,'
      '  res.DATE_CREATED,'
      '  res.USER_LAST_UPDATED,'
      '  res.DATE_LAST_UPDATED,'
      '  res.REMARK,'
      '  AC.COMPANY_NAME, '
      '  res.RECEIVED_PAYMENT_TYPE_NAME'
      'from '
      ''
      '('
      'SELECT '
      '  RP.PHONE_NUMBER,'
      '  RP.PAYMENT_SUM,'
      '  RP.PAYMENT_DATE_TIME,'
      '  nvl(usr_create.user_fio, RP.USER_CREATED)  USER_CREATED,'
      '  RP.DATE_CREATED,'
      
        '  nvl(usr_update.user_fio, RP.USER_LAST_UPDATED)  USER_LAST_UPDA' +
        'TED,'
      '  RP.DATE_LAST_UPDATED,'
      '  RP.REMARK,'
      
        '  (select account_id from DB_LOADER_ACCOUNT_PHONES db where  RP.' +
        'phone_number = DB.phone_number '
      
        '         AND to_number(to_char(RP.PAYMENT_DATE_TIME, '#39'yyyymm'#39')) ' +
        '= db.YEAR_MONTH  and rownum <= 1) account_id,'
      '  (select RPT.RECEIVED_PAYMENT_TYPE_NAME'
      '   from RECEIVED_PAYMENT_TYPES rpt'
      
        '   where RPT.RECEIVED_PAYMENT_TYPE_ID = RP.RECEIVED_PAYMENT_TYPE' +
        '_ID)  RECEIVED_PAYMENT_TYPE_NAME'
      '  '
      '  '
      '  FROM RECEIVED_PAYMENTS RP,'
      '      USER_NAMES usr_create,'
      '      USER_NAMES usr_update'
      '      '
      '      '
      '  WHERE RP.IS_CONTRACT_PAYMENT = 0'
      
        '  and to_number(to_char(RP.PAYMENT_DATE_TIME, '#39'yyyymm'#39')) = :PERI' +
        'OD '
      '  and UPPER(RP.USER_CREATED) = UPPER(usr_create.user_name(+))'
      
        '  and UPPER(RP.USER_LAST_UPDATED) = UPPER(usr_update.user_name(+' +
        ')) '
      ''
      ''
      '  ) res,'
      '   ACCOUNTS AC'
      '   where  res.account_id = ac.account_id(+)'
      '  ORDER BY res.DATE_CREATED DESC')
    FetchRows = 500
    Left = 248
    Top = 120
    ParamData = <
      item
        DataType = ftInteger
        Name = 'PERIOD'
      end>
    object qReportCOMPANY_NAME: TStringField
      DisplayLabel = #1050#1086#1084#1087#1072#1085#1080#1103
      FieldName = 'COMPANY_NAME'
      Size = 120
    end
    object qReportPHONE_NUMBER: TStringField
      DisplayLabel = #1058#1077#1083#1077#1092#1086#1085
      DisplayWidth = 13
      FieldName = 'PHONE_NUMBER'
      Required = True
      Size = 40
    end
    object qReportPAYMENT_SUM: TFloatField
      DisplayLabel = #1057#1091#1084#1084#1072
      FieldName = 'PAYMENT_SUM'
      Required = True
    end
    object qReportPAYMENT_DATE_TIME: TDateTimeField
      DisplayLabel = #1044#1072#1090#1072
      DisplayWidth = 10
      FieldName = 'PAYMENT_DATE_TIME'
      Required = True
    end
    object qReportUSER_CREATED: TStringField
      DisplayLabel = #1057#1086#1079#1076#1072#1090#1077#1083#1100
      DisplayWidth = 12
      FieldName = 'USER_CREATED'
      Size = 120
    end
    object qReportDATE_CREATED: TDateTimeField
      DisplayLabel = #1044#1072#1090#1072' '#1089#1086#1079#1076#1072#1085#1080#1103
      FieldName = 'DATE_CREATED'
    end
    object qReportUSER_LAST_UPDATED: TStringField
      DisplayLabel = #1048#1079#1084#1077#1085#1080#1083
      DisplayWidth = 12
      FieldName = 'USER_LAST_UPDATED'
      Size = 120
    end
    object qReportDATE_LAST_UPDATED: TDateTimeField
      DisplayLabel = #1044#1072#1090#1072' '#1080#1079#1084#1077#1085#1077#1085#1080#1103
      FieldName = 'DATE_LAST_UPDATED'
    end
    object qReportREMARK: TStringField
      DisplayLabel = #1055#1088#1080#1084#1077#1095#1072#1085#1080#1077
      DisplayWidth = 200
      FieldName = 'REMARK'
      Size = 2000
    end
    object qReportRECEIVED_PAYMENT_TYPE_NAME: TStringField
      FieldName = 'RECEIVED_PAYMENT_TYPE_NAME'
      Size = 200
    end
  end
  object dsReport: TDataSource
    DataSet = qReport
    Left = 328
    Top = 120
  end
  object qPeriod: TOraQuery
    SQL.Strings = (
      
        'select CONVERT_PCKG.MONTH_NAME(to_number(substr(to_char(period),' +
        ' 5, 2))) ||'#39' '#39'||substr(to_char(period), 1, 4) mm_year , period f' +
        'rom '
      '('
      'select '
      '  distinct '
      '  to_number(to_char(RP.PAYMENT_DATE_TIME, '#39'yyyymm'#39')) period'
      'from  RECEIVED_PAYMENTS RP'
      'where RP.IS_CONTRACT_PAYMENT = 0'
      ')'
      'order by period desc')
    Left = 264
    Top = 184
  end
end
