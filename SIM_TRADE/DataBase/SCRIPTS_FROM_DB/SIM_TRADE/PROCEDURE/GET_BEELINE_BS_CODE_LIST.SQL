
  CREATE OR REPLACE PROCEDURE "SIM_TRADE"."GET_BEELINE_BS_CODE_LIST" (
  pZONE_NAME IN VARCHAR2,
  oCODE_LIST OUT CLOB
  ) IS
--#Version=1
--
-- Возвращает список кодов базовых станций для тарифной зоны, разделённых ';'
--
  S VARCHAR2(500 CHAR);
BEGIN
--   
  DBMS_LOB.CREATETEMPORARY(oCODE_LIST, TRUE);
  FOR REC IN (
  SELECT BEELINE_BS_ZONES.BEELINE_BS_ZONE_ID
  FROM BEELINE_BS_ZONES
  WHERE BEELINE_BS_ZONES.ZONE_NAME=pZONE_NAME
  ) LOOP
    S := S || TO_CHAR(REC.BEELINE_BS_ZONE_ID)||';';
    IF LENGTH(S) > 400 THEN
      DBMS_LOB.APPEND(oCODE_LIST, S);
      S := NULL;
    END IF;
  END LOOP;
  -- Остаток списка
  DBMS_LOB.APPEND(oCODE_LIST, S);
END; 